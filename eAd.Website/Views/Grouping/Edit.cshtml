@using eAd.DataAccess
@model eAd.DataAccess.Grouping

@{
    ViewBag.Title = "Edit";
}

<h2>Edit</h2>
<link href="~/Content/themes/ui-lightness/jquery-ui-1.8.11.custom.css"/>
<script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery-ui.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>Group:  @(Model.Name) </legend>

        @Html.HiddenFor(model => model.GroupingID)

        <div class="editor-label">
            @Html.LabelFor(model => model.Name)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Name)
            @Html.ValidationMessageFor(model => model.Name)
        </div>
      

        <div class="editor-label">
             <h3>Stations: (@Model.Stations.Count())</h3>
        </div>
        <table>
        <tr>
         <th>In Group</th>
         <th>Not In Group</th>
         </tr>
        <tr>
       
      <td id="InGroup" style="min-height:100;min-width:60">
      
      <div class="editor-field">
   
        <ul id="lstIn_Group">
        @foreach (var item in (IEnumerable<SelectListItem>)ViewBag.AddedStations)
        {
            <li id="ns@(item.Value)" style="background-color: lightgray;margin-top:50" value="@(item.Value)"> @item.Text</li>
        }
        </ul>
        </div>
        
      
        </td>
      <td id="NotInGroup" style="min-height:100;min-width:60">
        <div class="editor-field">
       
          <ul id="lstNot_In_Group">
        @foreach (var item in (IEnumerable<SelectListItem>)ViewBag.NonAddedStations)
        {
            <li id="ns@(item.Value)" style="background-color: lightgray;margin-top:50" value="@(item.Value)"> @item.Text</li>
        }
        </ul>
        
        </div>
        </td></tr>
        </table>
             
        
         <div class="editor-label">
             <h3>Themes: (@Model.Themes.Count())</h3>
        </div>
        <table>
        <tr>
         <th>In Group</th>
         <th>Not In Group</th>
         </tr>
        <tr>
       
      <td id="ThemeInGroup" style="min-height:100;min-width:60">
      
      <div class="editor-field">
   
        <ul id="ThemelstIn_Group">
        @foreach (var item in (IEnumerable<SelectListItem>)ViewBag.AddedThemes)
        {
            <li id="ns@(item.Value)" style="background-color: lightgray;margin-top:50" value="@(item.Value)"> @item.Text</li>
        }
        </ul>
        </div>
        
      
        </td>
      <td id="ThemeNotInGroup" style="min-height:100;min-width:60">
        <div class="editor-field">
       
          <ul id="ThemelstNot_In_Group">
        @foreach (var item in (IEnumerable<SelectListItem>)ViewBag.NonAddedThemes)
        {
            <li id="ns@(item.Value)" style="background-color: lightgray;margin-top:50" value="@(item.Value)"> @item.Text</li>
        }
        </ul>
        
        </div>
        </td></tr>
        </table>

    
      
          @*  <div class="editor-label">
            @Html.LabelFor(model => model.CustomerID, "Customer")
        </div>
        <div class="editor-field">
            @Html.DropDownList("CustomerID", String.Empty)
            @Html.ValidationMessageFor(model => model.CustomerID)
        </div>*@

        <p>
            <input type="submit" value="Save" />
        </p>
    </fieldset>
}


 @*<style type="text/css">
        ul
        {
            float: left;
            width: 105px;
            background: silver;
            padding: 10px;
            color: Black;
            margin: 10px;
        }
        ul li
        {
            padding: 5px;
            margin: 5px;
            background-color: white;
            cursor: pointer;
        }
    </style>*@

    <script language="javascript" type="text/javascript">
        $(document).ready(function () {
            
            var fn = function (event, ui) {
                $.ajax({
                    url: "@(Url.Action("AddStation", "Grouping", null, "http"))",
                    type: 'POST',
                    context: document.body,
                    data: { stationID: $(ui.draggable[0]).attr('value'), groupID: "@Model.GroupingID" },
                    success: function () {
                           $("#lstIn_Group").append($(ui.draggable[0]).removeAttr("style").attr("style", "background-color: lightgray;margin-top:50"));
                      
                    }
                });
                  $("#lstIn_Group li").draggable();
                    $("#lstNot_In_Group li").draggable();
            };
                var fn1 = function (event, ui) 
                {
                //                $("#lstNot_In_Group").append($(ui.draggable[0]).removeAttr("style"));
           
                      $.ajax({
                    url: "@(Url.Action("RemoveStation", "Grouping", null, "http"))",
                    type: 'POST',
                    context: document.body,
                    data: { stationID: $(ui.draggable[0]).attr('value'), groupID: "@Model.GroupingID" },
                    success: function () {
                             $("#lstNot_In_Group").append($(ui.draggable[0]).removeAttr("style").attr("style", "background-color: lightgray;margin-top:50"));
            
                 
                    }
                    
                });
                             $("#lstIn_Group li").draggable();
                    $("#lstNot_In_Group li").draggable();
            };
            
             var Themefn = function (event, ui) {
                $.ajax({
                    url: "@(Url.Action("AddTheme", "Grouping", null, "http"))",
                    type: 'POST',
                    context: document.body,
                    data: { stationID: $(ui.draggable[0]).attr('value'), groupID: "@Model.GroupingID" },
                    success: function () {
                           $("#ThemelstIn_Group").append($(ui.draggable[0]).removeAttr("style").attr("style", "background-color: lightgray;margin-top:50"));
                      
                    }
                });
                  $("#ThemelstIn_Group li").draggable();
                    $("#ThemelstNot_In_Group li").draggable();
            };
                var Themefn1 = function (event, ui) 
                {
                //                $("#lstNot_In_Group").append($(ui.draggable[0]).removeAttr("style"));
           
                      $.ajax({
                    url: "@(Url.Action("RemoveTheme", "Grouping", null, "http"))",
                    type: 'POST',
                    context: document.body,
                    data: { stationID: $(ui.draggable[0]).attr('value'), groupID: "@Model.GroupingID" },
                    success: function () {
                             $("#ThemelstNot_In_Group").append($(ui.draggable[0]).removeAttr("style").attr("style", "background-color: lightgray;margin-top:50"));
            
                 
                    }
                    
                });
                             $("#ThemelstIn_Group li").draggable();
                    $("#ThemelstNot_In_Group li").draggable();
            };

            $("#lstNot_In_Group li").draggable();
        
            $("#InGroup").droppable({ drop: fn });

            $("#lstIn_Group li").draggable(); // { helper: 'clone' } not good
            $("#NotInGroup").droppable({ drop: fn1 });
            
               $("#ThemelstNot_In_Group li").draggable();
        
            $("#ThemeInGroup").droppable({ drop: Themefn });

            $("#ThemelstIn_Group li").draggable(); // { helper: 'clone' } not good
            $("#ThemeNotInGroup").droppable({ drop: Themefn1 });
            
          
        });
    </script>

    
    <br />
 

<div>
    @Html.ActionLink("Back to List", "Index")
</div>

@*<script language="javascript" type="text/javascript">


    $(document).ready(function () {

        $("select option").each(function () {
            $(this).draggable({ helper: 'clone' });
        });

      //  $("#lstNot_In_Group").draggable({ helper: 'clone' });
        $("#lstIn_Group").draggable({ helper: 'clone' });
        $("#lstNot_In_Group").droppable({
            accept: ".block",
            activeClass: 'droppable-active',
            hoverClass: 'droppable-hover',
            drop: function (ev, ui) {

                document.getElementById("display").innerHTML = $(ui.draggable).children("li:first").text();

                var lid = ($(ui.draggable).children("li:first"));

                var removeLink = document.createElement("a");
                removeLink.innerHTML = "remove";
                removeLink.href = "#";
                removeLink.onclick = function () {
                    $("#drop1").children().remove("#" + lid[0].id);
                    $(this).remove();
                };
                $(this).append($(ui.draggable).clone().children("li:first").addClass("blocker"));
                $(this).append(removeLink);

            }
        });

    });
    </script>*@


    
